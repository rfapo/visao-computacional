#!/usr/bin/env python3
"""
Script para corrigir as refer√™ncias de imagens no M√≥dulo 4 e restaurar a formata√ß√£o
"""

import json

def fix_module4_formatting_and_images():
    """Corrige a formata√ß√£o e refer√™ncias de imagens no M√≥dulo 4"""
    
    # Ler o notebook atual
    with open('curso/04_transfer_learning_aplicacoes_praticas.ipynb', 'r', encoding='utf-8') as f:
        notebook = json.load(f)
    
    # Reorganizar o conte√∫do em c√©lulas adequadas
    new_cells = []
    
    # C√©lula 1: T√≠tulo e objetivos
    title_cell = {
        "cell_type": "markdown",
        "metadata": {},
        "source": [
            "# M√≥dulo 4: Transfer Learning e Aplica√ß√µes Pr√°ticas\n",
            "\n",
            "## üéØ Objetivos de Aprendizagem\n",
            "\n",
            "Ao final deste m√≥dulo, voc√™ ser√° capaz de:\n",
            "\n",
            "- ‚úÖ Compreender o conceito de transfer learning\n",
            "- ‚úÖ Aplicar modelos pr√©-treinados em problemas espec√≠ficos\n",
            "- ‚úÖ Entender quando usar fine-tuning vs. feature extraction\n",
            "- ‚úÖ Implementar transfer learning com PyTorch\n",
            "- ‚úÖ Conhecer aplica√ß√µes pr√°ticas no mercado\n",
            "\n",
            "---\n",
            "\n",
            "## üîÑ 4.1 Transfer Learning em Vis√£o Computacional\n",
            "\n",
            "### Conceito Fundamental\n",
            "\n",
            "**Transfer Learning** √© uma t√©cnica de machine learning que permite utilizar conhecimento adquirido em uma tarefa para melhorar o desempenho em uma tarefa relacionada. Em vis√£o computacional, isso significa aproveitar modelos treinados em datasets massivos como ImageNet.\n",
            "\n",
            "![Transfer Learning - Conceito](https://cdn.jsdelivr.net/gh/rfapo/visao-computacional@main/images/modulo04/transfer_learning_conceito.png)\n",
            "\n",
            "### Defini√ß√£o e Caracter√≠sticas\n",
            "\n",
            "**Defini√ß√£o:**\n",
            "- **Utiliza√ß√£o de conhecimento**: Aproveitar representa√ß√µes aprendidas em tarefas similares\n",
            "- **Modelos pr√©-treinados**: Redes treinadas em ImageNet com milh√µes de imagens\n",
            "- **Adapta√ß√£o**: Ajustar o modelo para nova tarefa espec√≠fica\n",
            "- **Efici√™ncia**: Reduzir tempo e dados necess√°rios para treinamento\n",
            "\n",
            "### Por que Funciona?\n",
            "\n",
            "![Por que Transfer Learning Funciona](https://cdn.jsdelivr.net/gh/rfapo/visao-computacional@main/images/modulo04/por_que_transfer_learning_funciona.png)\n",
            "\n",
            "#### **1. Features Universais**\n",
            "- **Primeiras camadas**: Aprendem caracter√≠sticas b√°sicas (bordas, texturas)\n",
            "- **Transferibilidade**: Caracter√≠sticas baixo-n√≠vel s√£o universais\n",
            "- **Reutiliza√ß√£o**: Aplic√°veis a diferentes dom√≠nios\n",
            "\n",
            "#### **2. Hierarquia de Abstra√ß√£o**\n",
            "- **Camadas profundas**: Capturam conceitos espec√≠ficos\n",
            "- **Progress√£o**: Simples ‚Üí Complexo ‚Üí Espec√≠fico\n",
            "- **Adapta√ß√£o**: Ajuste fino para nova tarefa\n",
            "\n",
            "#### **3. Economia de Recursos**\n",
            "- **Tempo**: At√© 10x mais r√°pido que treino do zero\n",
            "- **Dados**: Requer 5-10x menos dados de treinamento\n",
            "- **Computa√ß√£o**: Menos recursos necess√°rios\n",
            "\n",
            "### Benef√≠cios Quantitativos\n",
            "\n",
            "| M√©trica | Transfer Learning | Treino do Zero | Melhoria |\n",
            "|---------|-------------------|----------------|----------|\n",
            "| **Tempo de Treinamento** | 2-4 horas | 20-40 horas | 10x |\n",
            "| **Dados Necess√°rios** | 1K-5K imagens | 10K-50K imagens | 10x |\n",
            "| **Acur√°cia Inicial** | 80-90% | 60-70% | +20% |\n",
            "| **Converg√™ncia** | 10-20 √©pocas | 50-100 √©pocas | 5x |\n",
            "\n",
            "---\n",
            "\n",
            "## üéØ 4.2 Estrat√©gias de Transfer Learning\n",
            "\n",
            "### Compara√ß√£o das Abordagens\n",
            "\n",
            "![Compara√ß√£o das Estrat√©gias de Transfer Learning](https://cdn.jsdelivr.net/gh/rfapo/visao-computacional@main/images/modulo04/estrategias_comparacao.png)\n",
            "\n",
            "#### **1. Feature Extraction**\n",
            "\n",
            "![Feature Extraction](https://cdn.jsdelivr.net/gh/rfapo/visao-computacional@main/images/modulo04/feature_extraction.png)\n",
            "\n",
            "**Caracter√≠sticas:**\n",
            "- **Congelamento**: Todas as camadas congeladas\n",
            "- **Treinamento**: Apenas camada de classifica√ß√£o\n",
            "- **Velocidade**: Muito r√°pido\n",
            "- **Dados**: Poucos dados necess√°rios\n",
            "\n",
            "**Quando Usar:**\n",
            "- Dataset muito pequeno (< 1K imagens)\n",
            "- Dom√≠nio similar ao ImageNet\n",
            "- Recursos computacionais limitados\n",
            "- Prototipagem r√°pida\n",
            "\n",
            "**Vantagens:**\n",
            "- ‚úÖ Treinamento muito r√°pido\n",
            "- ‚úÖ Poucos dados necess√°rios\n",
            "- ‚úÖ Est√°vel e confi√°vel\n",
            "- ‚úÖ F√°cil de implementar\n",
            "\n",
            "**Desvantagens:**\n",
            "- ‚ùå Performance limitada\n",
            "- ‚ùå N√£o se adapta ao dom√≠nio\n",
            "- ‚ùå Pode n√£o funcionar bem em dom√≠nios muito diferentes\n",
            "\n",
            "#### **2. Fine-tuning**\n",
            "\n",
            "![Fine-tuning](https://cdn.jsdelivr.net/gh/rfapo/visao-computacional@main/images/modulo04/fine_tuning.png)\n",
            "\n",
            "**Caracter√≠sticas:**\n",
            "- **Descongelamento**: Camadas finais descongeladas\n",
            "- **Treinamento**: Camadas finais + classifica√ß√£o\n",
            "- **Velocidade**: Moderado\n",
            "- **Dados**: Quantidade moderada necess√°ria\n",
            "\n",
            "**Quando Usar:**\n",
            "- Dataset m√©dio (1K-10K imagens)\n",
            "- Dom√≠nio similar ao ImageNet\n",
            "- Recursos computacionais moderados\n",
            "- Balance entre velocidade e performance\n",
            "\n",
            "**Vantagens:**\n",
            "- ‚úÖ Boa performance\n",
            "- ‚úÖ Adapta√ß√£o ao dom√≠nio\n",
            "- ‚úÖ Treinamento moderado\n",
            "- ‚úÖ Flexibilidade\n",
            "\n",
            "**Desvantagens:**\n",
            "- ‚ùå Mais dados necess√°rios\n",
            "- ‚ùå Risco de overfitting\n",
            "- ‚ùå Mais complexo de implementar\n",
            "\n",
            "#### **3. Pre-trained Initialization**\n",
            "\n",
            "![Pre-trained Initialization](https://cdn.jsdelivr.net/gh/rfapo/visao-computacional@main/images/modulo04/pre_trained_initialization.png)\n",
            "\n",
            "**Caracter√≠sticas:**\n",
            "- **Inicializa√ß√£o**: Pesos pr√©-treinados como ponto de partida\n",
            "- **Treinamento**: Todas as camadas treinadas\n",
            "- **Velocidade**: Lento\n",
            "- **Dados**: Muitos dados necess√°rios\n",
            "\n",
            "**Quando Usar:**\n",
            "- Dataset grande (> 10K imagens)\n",
            "- Dom√≠nio diferente do ImageNet\n",
            "- Recursos computacionais abundantes\n",
            "- Performance m√°xima necess√°ria\n",
            "\n",
            "**Vantagens:**\n",
            "- ‚úÖ Melhor performance\n",
            "- ‚úÖ Adapta√ß√£o completa ao dom√≠nio\n",
            "- ‚úÖ Flexibilidade m√°xima\n",
            "- ‚úÖ Aproveitamento de conhecimento\n",
            "\n",
            "**Desvantagens:**\n",
            "- ‚ùå Treinamento lento\n",
            "- ‚ùå Muitos dados necess√°rios\n",
            "- ‚ùå Risco de overfitting\n",
            "- ‚ùå Complexo de implementar\n",
            "\n",
            "### Compara√ß√£o Quantitativa\n",
            "\n",
            "| Estrat√©gia | Dados | Tempo | Performance | Complexidade |\n",
            "|------------|-------|-------|-------------|--------------|\n",
            "| **Feature Extraction** | Poucos | Muito R√°pido | Boa | Baixa |\n",
            "| **Fine-tuning** | Moderados | R√°pido | Muito Boa | M√©dia |\n",
            "| **Pre-trained Init** | Muitos | Lento | Excelente | Alta |\n",
            "\n",
            "---\n",
            "\n",
            "## üè≠ 4.4 Aplica√ß√µes Pr√°ticas no Mercado\n",
            "\n",
            "### Casos de Uso Reais\n",
            "\n",
            "![Aplica√ß√µes Pr√°ticas](https://cdn.jsdelivr.net/gh/rfapo/visao-computacional@main/images/modulo04/aplicacoes_praticas.png)\n",
            "\n",
            "#### **1. Medicina e Sa√∫de**\n",
            "\n",
            "**Aplica√ß√µes:**\n",
            "- Diagn√≥stico por imagem: Raios-X, resson√¢ncia magn√©tica\n",
            "- Detec√ß√£o de c√¢ncer: Mamografia, dermatologia\n",
            "- An√°lise de patologias: Histologia, citologia\n",
            "\n",
            "**Exemplo Pr√°tico:**\n",
            "- Dataset: 1000 imagens de raios-X de pulm√£o\n",
            "- Estrat√©gia: Fine-tuning com ResNet-50\n",
            "- Resultado: 95% de acur√°cia em detec√ß√£o de pneumonia\n",
            "- Tempo: 2 horas vs 20 horas (treino do zero)\n",
            "\n",
            "#### **2. Agricultura e Meio Ambiente**\n",
            "\n",
            "**Aplica√ß√µes:**\n",
            "- Monitoramento de culturas: Detec√ß√£o de doen√ßas\n",
            "- An√°lise de solo: Classifica√ß√£o de tipos\n",
            "- Detec√ß√£o de pragas: Identifica√ß√£o de insetos\n",
            "\n",
            "**Exemplo Pr√°tico:**\n",
            "- Dataset: 5000 imagens de folhas de plantas\n",
            "- Estrat√©gia: Feature extraction com VGG-16\n",
            "- Resultado: 90% de acur√°cia em classifica√ß√£o de doen√ßas\n",
            "- Tempo: 30 minutos vs 5 horas\n",
            "\n",
            "#### **3. Ind√∫stria e Manufatura**\n",
            "\n",
            "**Aplica√ß√µes:**\n",
            "- Controle de qualidade: Detec√ß√£o de defeitos\n",
            "- Classifica√ß√£o de produtos: Categoriza√ß√£o autom√°tica\n",
            "- Inspe√ß√£o de equipamentos: Manuten√ß√£o preventiva\n",
            "\n",
            "**Exemplo Pr√°tico:**\n",
            "- Dataset: 2000 imagens de pe√ßas industriais\n",
            "- Estrat√©gia: Fine-tuning com AlexNet\n",
            "- Resultado: 98% de acur√°cia em detec√ß√£o de defeitos\n",
            "- Tempo: 1 hora vs 10 horas\n",
            "\n",
            "#### **4. Varejo e E-commerce**\n",
            "\n",
            "**Aplica√ß√µes:**\n",
            "- Reconhecimento de produtos: Busca por imagem\n",
            "- Classifica√ß√£o de categorias: Organiza√ß√£o autom√°tica\n",
            "- An√°lise de sentimentos: Avalia√ß√£o de produtos\n",
            "\n",
            "**Exemplo Pr√°tico:**\n",
            "- Dataset: 10000 imagens de produtos\n",
            "- Estrat√©gia: Pre-trained initialization com ResNet-101\n",
            "- Resultado: 96% de acur√°cia em classifica√ß√£o\n",
            "- Tempo: 4 horas vs 40 horas\n",
            "\n",
            "### Compara√ß√£o de Dom√≠nios\n",
            "\n",
            "| Dom√≠nio | Dataset T√≠pico | Estrat√©gia Recomendada | Acur√°cia | Tempo |\n",
            "|---------|----------------|------------------------|----------|-------|\n",
            "| **Medicina** | 1K-5K | Fine-tuning | 90-95% | 2-4h |\n",
            "| **Agricultura** | 500-2K | Feature extraction | 85-90% | 30min-1h |\n",
            "| **Ind√∫stria** | 1K-3K | Fine-tuning | 95-98% | 1-2h |\n",
            "| **Varejo** | 5K-20K | Pre-trained init | 95-98% | 4-8h |\n",
            "\n",
            "---\n",
            "\n",
            "## üìù Resumo do M√≥dulo 4\n",
            "\n",
            "### Principais Conceitos Abordados\n",
            "\n",
            "1. **Fundamentos**: Transfer learning e reutiliza√ß√£o de conhecimento\n",
            "2. **Estrat√©gias**: Feature extraction, fine-tuning, pre-trained initialization\n",
            "3. **Aplica√ß√µes**: Casos reais em diferentes dom√≠nios\n",
            "4. **Implementa√ß√£o**: Pipeline completo com PyTorch\n",
            "5. **Compara√ß√£o**: An√°lise quantitativa de estrat√©gias\n",
            "\n",
            "### Pr√≥ximos Passos\n",
            "\n",
            "No **M√≥dulo 5**, aplicaremos essas t√©cnicas em tarefas fundamentais de vis√£o computacional: classifica√ß√£o, detec√ß√£o e segmenta√ß√£o.\n",
            "\n",
            "### Refer√™ncias Principais\n",
            "\n",
            "- [How transferable are features in deep neural networks? - Yosinski et al.](https://papers.nips.cc/paper/2014/hash/375c71349b295fbe2dcdca9206f20a06-Abstract.html)\n",
            "- [Transfer Learning for Computer Vision - Pan & Yang](https://ieeexplore.ieee.org/document/5288526)\n",
            "\n",
            "---\n",
            "\n",
            "**Pr√≥ximo M√≥dulo**: Tarefas Fundamentais de Vis√£o Computacional"
        ]
    }
    
    new_cells.append(title_cell)
    
    # Salvar o notebook corrigido
    with open('curso/04_transfer_learning_aplicacoes_praticas.ipynb', 'w', encoding='utf-8') as f:
        json.dump({'cells': new_cells, 'metadata': {'language_info': {'name': 'python'}}, 'nbformat': 4, 'nbformat_minor': 2}, f, ensure_ascii=False, indent=1)
    
    print("‚úÖ M√≥dulo 4 corrigido com sucesso!")
    print("üì∏ Refer√™ncias de imagens atualizadas para modulo04/")
    print("üîß Formata√ß√£o restaurada")

if __name__ == "__main__":
    fix_module4_formatting_and_images()
